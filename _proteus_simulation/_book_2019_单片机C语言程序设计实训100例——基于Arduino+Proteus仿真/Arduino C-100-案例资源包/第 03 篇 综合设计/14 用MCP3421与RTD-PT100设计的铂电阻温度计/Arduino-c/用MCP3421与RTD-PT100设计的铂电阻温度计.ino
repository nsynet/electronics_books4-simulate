//-----------------------------------------------------------------
//  名称:用MCP3421与RTD-PT100设计的铂电阻温度计
//-----------------------------------------------------------------
//  说明: 本例MCP3421工作于18位精度模式,程序运行时,根据模/数转换结果
//		  得到阻值,然后根据Callendar-Van Dusen温度/电阻关系式求解方程,
//		  得出-200℃ ~ 850℃范围内的温度值,显示在128*64液晶屏上.
//
//-----------------------------------------------------------------
#include <Arduino.h>
#include <U8g2lib.h>
#include <Wire.h>
#include "MyU8g2fonts.c"
//-----------------------------------------------------------------
U8G2_SSD1306_128X64_NONAME_1_4W_SW_SPI u8g2(U8G2_R0, /* clock=*/ 13, 
/* data=*/ 11, /* cs=*/ 10, /* dc=*/ 9, /* reset=*/ 8);
//-----------------------------------------------------------------
// 相关定义
//-----------------------------------------------------------------
#define MCP3421_DEV_ADDR 	0xD0>>1	//MCP3421器件地址定义(写)
long AD_Result;						//模数转换结果
//ITS-90/IEC751(α = 0.0038505),PT100标准系数
#define coeffA ( 3.9083/1000.0)
#define coeffB (-5.775/10000000.0)
#define coeffC (-4.183/1000000000000.0)
#define R0 100.0  					//PT100在0℃的阻值
#define Gain 4						//增益配置
uint8_t d[4];						//MCP3421 A/D转换器结果字节暂存数组
float Res,Temp;						//PT100电阻值,当前温度
char disp_Buff[10];					//显示缓冲
//-----------------------------------------------------------------
// 初始配置
//-----------------------------------------------------------------
void setup() {

}
//-----------------------------------------------------------------
// 主循环
//-----------------------------------------------------------------
void loop() {

}
//-----------------------------------------------------------------
// 读取温度并转换为字符串
//-----------------------------------------------------------------
void Get_temp_trans_to_str() {

}
//-----------------------------------------------------------------
// 向MCP3421写配置字节
//-----------------------------------------------------------------
void Write_MCP3421(uint8_t d) {

}
//-----------------------------------------------------------------
// 从MCP3421读取A/D转换结果,前3字节为转换数据,最后1字节为配置或状态字节
//-----------------------------------------------------------------
void Read_MCP3421(uint8_t *d, uint8_t n) {

}
//-----------------------------------------------------------------
// 根据从MCP3421所读取的三字节模数转换结果计算得到电阻值
// 模数转换精度:18位 增益:4 恒流源:1mA
//-----------------------------------------------------------------
void GetRes() {

}
//-----------------------------------------------------------------
// 正温度直接使用解析法求根
//-----------------------------------------------------------------
void Calc_2_equation(float r) {

}
//-----------------------------------------------------------------
// 用牛顿法求解Callendar-Van Dusen方程,根据阻值求取温度值
//-----------------------------------------------------------------
void Calc_Temp_Newton() {

}