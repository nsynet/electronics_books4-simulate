//中断形式产生1S定时

//=======声明区=========================================================================================
#include<reg51.h>
#define led P2                                           //定义LED灯接P2口          
int sec20=0;                                            //用来存放50ms的次数，初始值为0   
//================主程序===============================================================================
main( )
{
TH0=(65536-50000)/256;                               //定时器高8位的初始值
TL0=(65536-50000)%256;                               //定时器低8位的初始值
TMOD=0x01;                                          //采用定时器0，方式1
EA=1                                                 //打开中断总开关
ET0=1;                                                //打开定时器0中断开关
TR0=1;                                               //启动定时器0
led=0x0f;                                             //LED的初始状态：高4位亮，低4位灭
while(1);	                                          // 无穷循环
}
//================T0中断子程序========================================================================
void onesec(void) interrupt 1     //定时器0中断
{
	TH0=(65536-50000)/256;	                 //重新加载初始值，再次计50ms
	TL0=(65536-50000)%256;		  
	sec20++;				                 //每50ms加1
	if(sec20==20)				                 //计到20次，即1秒
		{
		 led=~led;	                              //LED灯的状态取反，实现高低4位灯交替闪烁                     
		 sec20=0;				                //sec20清0
		 }	
}